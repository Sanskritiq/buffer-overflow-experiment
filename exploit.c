#include <stdlib.h>
#include <stdio.h>
#include <string.h>

#define BUFFER_SIZE 10

void exploitable(char *arg)
{
    char buffer[BUFFER_SIZE];
    size_t length = strnlen(arg, BUFFER_SIZE); // Use safer strnlen
    memcpy(buffer, arg, length);
    buffer[length] = '\0'; // Ensure null-terminated
    printf("The buffer says .. [%s/%p].\n", buffer, &buffer);
}

int main(int argc, char **argv)
{
    char exploit[BUFFER_SIZE + 4];
    memset(exploit, 0x41, BUFFER_SIZE + 4);
    *(unsigned int *)(exploit + BUFFER_SIZE) = 0x11a9;
    exploitable(exploit);
    return 0;
}
