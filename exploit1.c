#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>

#define BUFFER_SIZE 10

void exploitable(char *arg)
{
    char buffer[BUFFER_SIZE];
    size_t length = strnlen(arg, BUFFER_SIZE); // Use safer strnlen
    memcpy(buffer, arg, length);
    buffer[length] = '\0'; // Ensure null-terminated
    printf("The buffer says .. [%s/%p].\n", buffer, &buffer);
}

// Add a function prototype for the main function in sanskriti.c
void sanskriti_main();

int main(int argc, char **argv)
{
    char exploit[BUFFER_SIZE + sizeof(void *)]; // Adjust size to fit address
    memset(exploit, 0x41, BUFFER_SIZE);

    // Overwrite the return address with the address of sanskriti_main
    *(void **)(exploit + BUFFER_SIZE) = (void *)sanskriti_main;

    exploitable(exploit);
    return 0;
}

// Define the main function in sanskriti.c
void sanskriti_main()
{
    printf("Name: Sanskriti\n");
    printf("Class: CSE\n");
    time_t now = time(NULL);
    printf("Date and Time: %s\n", ctime(&now));
    exit(0); // Terminate the program after printing
}
